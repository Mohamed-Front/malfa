import{_ as j,u as z,x as L,r as c,y as O,o as H,i as J,l as b,b as n,c as i,j as e,t as r,q as P,z as U,F as h,A as g,B as K,C as q,a as w,D as A,s as N,v as Q}from"./index-54e2407f.js";const D=f=>(N("data-v-11373001"),f=f(),Q(),f),W={class:"permission-manager"},X={class:"controls"},Y={class:"name-input"},Z={for:"roleName"},ee=D(()=>e("span",{class:"required"},"*",-1)),te=["placeholder"],se={class:"name-input"},le={for:"roleName"},oe=D(()=>e("span",{class:"required"},"*",-1)),ae=["placeholder"],ne={key:0,class:"loading"},ie={key:0,class:"table-view"},de=D(()=>e("thead",null,[e("tr",null,[e("th",null,"Group"),e("th",null,"Permission"),e("th",null,"Description"),e("th",null,"Select")])],-1)),re=["rowspan"],ce=["id","checked",".indeterminate","onChange"],ue=["for"],ve=["onClick","disabled"],_e=["id","value"],pe={key:1,class:"card-view"},he={class:"permission-groups"},me={class:"group-header"},be=["id","checked",".indeterminate","onChange"],fe=["for"],ke={class:"permission-items"},ye={class:"permission-info"},$e=["id","value"],ge=["for"],Ce=["onClick","disabled"],we=["disabled"],De={class:"modal-content"},xe={setup(f){const B=z(),C=L(),v=c({}),k=c(null),y=c(!0),d=c([]),_=c(""),m=c(""),$=c(!1),x=c(""),G=c(!1),R=O(()=>C.params.id),E=()=>{w.get("api/role/get/permissions").then(l=>{v.value=l.data.data,R.value?F():y.value=!1})},F=()=>{w.get(`api/role/${C.params.id}`).then(l=>{k.value=l.data.data,_.value=k.value.name_en,m.value=k.value.name_ar,d.value=k.value.permissions.map(t=>t.id),y.value=!1}).catch(()=>{y.value=!1})},I=(l,t)=>{const a=(v.value[l]||[]).map(s=>s.id);t.target.checked?d.value=[...new Set([...d.value,...a])]:d.value=d.value.filter(s=>!a.includes(s))},V=l=>{const t=v.value[l]||[];return t.length===0?!1:t.every(p=>d.value.includes(p.id))},S=l=>{const t=v.value[l]||[];if(t.length===0)return!1;const p=t.some(s=>d.value.includes(s.id)),a=t.every(s=>d.value.includes(s.id));return p&&!a},M=l=>{x.value=l||"No description available",$.value=!0},T=()=>{if(!_.value){alert("Please enter a role name");return}const l={name_en:_.value,name_ar:m.value,permissions:d.value};w.put(`/api/role/${C.params.id}`,l).then(t=>{B.push({name:"roles"})}).catch(t=>{console.error("Error:",t)})};return H(()=>{E()}),(l,t)=>{const p=J("can");return b((n(),i("div",W,[e("h1",null,r(l.$t("role.role_Permissions_Manager")),1),e("div",X,[e("div",Y,[e("label",Z,[P(r(l.$t("role.role_Name_ar")),1),ee]),b(e("input",{type:"text",id:"roleName","onUpdate:modelValue":t[0]||(t[0]=a=>m.value=a),placeholder:l.$t("role.role_Name_ar"),required:""},null,8,te),[[U,m.value]])]),e("div",se,[e("label",le,[P(r(l.$t("role.role_Name_en")),1),oe]),b(e("input",{type:"text",id:"roleName","onUpdate:modelValue":t[1]||(t[1]=a=>_.value=a),placeholder:l.$t("role.role_Name_en"),required:""},null,8,ae),[[U,_.value]])])]),y.value?(n(),i("div",ne,r(l.$t("role.loading_permissions")),1)):(n(),i(h,{key:1},[G.value?(n(),i("div",ie,[e("table",null,[de,e("tbody",null,[(n(!0),i(h,null,g(v.value,(a,s)=>(n(),i(h,{key:s},[(n(!0),i(h,null,g(a,o=>(n(),i("tr",{key:o.id},[a.indexOf(o)===0?(n(),i("td",{key:0,rowspan:a.length},[e("input",{class:"mx-2 my-auto",type:"checkbox",id:`group-${s}-table`,checked:V(s),".indeterminate":S(s),onChange:u=>I(s,u)},null,40,ce),e("label",{for:`group-${s}-table`},r(s.charAt(0).toUpperCase()+s.slice(1)),9,ue)],8,re)):q("",!0),e("td",null,r(o.translated_name),1),e("td",null,[e("button",{onClick:u=>M(o.description),class:"description-btn",disabled:!o.description},r(o.description?"View":"None"),9,ve)]),e("td",null,[b(e("input",{class:"mx-2 my-auto",type:"checkbox",id:`permission-${o.id}-table`,value:o.id,"onUpdate:modelValue":t[2]||(t[2]=u=>d.value=u)},null,8,_e),[[A,d.value]])])]))),128))],64))),128))])])])):(n(),i("div",pe,[e("div",he,[(n(!0),i(h,null,g(v.value,(a,s)=>(n(),i("div",{key:s,class:"permission-group"},[e("div",me,[e("input",{class:"mx-2 my-auto",type:"checkbox",id:`group-${s}`,checked:V(s),".indeterminate":S(s),onChange:o=>I(s,o)},null,40,be),e("label",{for:`group-${s}`},r(s.charAt(0).toUpperCase()+s.slice(1)),9,fe)]),e("div",ke,[(n(!0),i(h,null,g(a,o=>(n(),i("div",{key:o.id,class:"permission-item"},[e("div",ye,[b(e("input",{type:"checkbox",id:`permission-${o.id}`,value:o.id,"onUpdate:modelValue":t[3]||(t[3]=u=>d.value=u)},null,8,$e),[[A,d.value]]),e("label",{for:`permission-${o.id}`},r(o.translated_name),9,ge)]),e("button",{onClick:u=>M(o.description),class:"description-btn",disabled:!o.description},r(o.description?"View Description":l.$t("role.No_Description")),9,Ce)]))),128))])]))),128))])]))],64)),e("button",{onClick:T,class:"submit-btn",disabled:d.value.length===0||!_.value||!m.value},r(l.$t("role.update_Role_with_Selected_Permissions")),9,we),$.value?(n(),i("div",{key:2,class:"modal-overlay",onClick:t[5]||(t[5]=K(a=>$.value=!1,["self"]))},[e("div",De,[e("h3",null,r(l.$t("role.permission_Description")),1),e("p",null,r(x.value),1),e("button",{onClick:t[4]||(t[4]=a=>$.value=!1),class:"close-modal"},"Close")])])):q("",!0)])),[[p,"create roles"]])}}},Ve=j(xe,[["__scopeId","data-v-11373001"]]);export{Ve as default};
