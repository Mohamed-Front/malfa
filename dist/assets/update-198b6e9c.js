import{p as T,y as q,u as W,r as c,H as j,o as H,C as J,E as $,e as a,f as i,h as e,t as r,j as D,m as K,I as L,F as _,k as g,J as O,n as E,b as I,K as G,s as z,v as Q}from"./index-cc239839.js";const V=m=>(z("data-v-370d5b0f"),m=m(),Q(),m),X={class:"permission-manager"},Y={class:"controls"},Z={class:"name-input"},N={for:"roleName"},ee=V(()=>e("span",{class:"required"},"*",-1)),te=["placeholder"],se={key:0,class:"loading"},oe={key:0,class:"table-view"},le=V(()=>e("thead",null,[e("tr",null,[e("th",null,"Group"),e("th",null,"Permission"),e("th",null,"Description"),e("th",null,"Select")])],-1)),ne=["rowspan"],ae=["id","checked",".indeterminate","onChange"],ie=["for"],de=["onClick","disabled"],re=["id","value"],ce={key:1,class:"card-view"},ue={class:"permission-groups"},ve={class:"group-header"},pe=["id","checked",".indeterminate","onChange"],he=["for"],_e={class:"permission-items"},me={class:"permission-info"},be=["id","value"],fe=["for"],ke=["onClick","disabled"],ye=["disabled"],$e={class:"modal-content"},ge=V(()=>e("h3",null,"Permission Description",-1)),Ce={setup(m){const A=q(),C=W(),v=c({}),w=c(null),b=c(!0),d=c([]),p=c(""),f=c(!1),S=c(""),k=c(!1),y=j(()=>C.params.id),B=()=>{I.get("api/role/get/permissions").then(o=>{v.value=o.data.data,y.value?F():b.value=!1})},F=()=>{I.get(`api/role/${C.params.id}`).then(o=>{w.value=o.data.data,p.value=w.value.name,d.value=w.value.permissions.map(t=>t.id),b.value=!1}).catch(()=>{b.value=!1})},x=(o,t)=>{const n=(v.value[o]||[]).map(s=>s.id);t.target.checked?d.value=[...new Set([...d.value,...n])]:d.value=d.value.filter(s=>!n.includes(s))},P=o=>{const t=v.value[o]||[];return t.length===0?!1:t.every(h=>d.value.includes(h.id))},M=o=>{const t=v.value[o]||[];if(t.length===0)return!1;const h=t.some(s=>d.value.includes(s.id)),n=t.every(s=>d.value.includes(s.id));return h&&!n},U=o=>{S.value=o||"No description available",f.value=!0},R=()=>{if(!p.value){alert("Please enter a role name");return}const o={name:p.value,permissions:d.value};I.put(`/api/role/${C.params.id}`,o).then(t=>{A.push({name:"roles"})}).catch(t=>{console.error("Error:",t)})};return H(()=>{B()}),(o,t)=>{const h=J("can");return $((a(),i("div",X,[e("h1",null,r(D(y)?o.$t("permissions.edit"):o.$t("permissions.create")),1),e("div",Y,[e("div",Z,[e("label",N,[K(r(o.$t("role.role_Name"))+" ",1),ee]),$(e("input",{type:"text",id:"roleName","onUpdate:modelValue":t[0]||(t[0]=n=>p.value=n),placeholder:o.$t("role.enter_role_name"),required:""},null,8,te),[[L,p.value]])]),e("button",{onClick:t[1]||(t[1]=n=>k.value=!k.value),class:"view-toggle"},r(k.value?"Switch to Card View":"Switch to Table View"),1)]),b.value?(a(),i("div",se,r(D(y)?o.$t("loading.roleData"):o.$t("loading.permissions")),1)):(a(),i(_,{key:1},[k.value?(a(),i("div",oe,[e("table",null,[le,e("tbody",null,[(a(!0),i(_,null,g(v.value,(n,s)=>(a(),i(_,{key:s},[(a(!0),i(_,null,g(n,l=>(a(),i("tr",{key:l.id},[n.indexOf(l)===0?(a(),i("td",{key:0,rowspan:n.length},[e("input",{type:"checkbox",id:`group-${s}-table`,checked:P(s),".indeterminate":M(s),onChange:u=>x(s,u)},null,40,ae),e("label",{for:`group-${s}-table`},r(s.charAt(0).toUpperCase()+s.slice(1)),9,ie)],8,ne)):E("",!0),e("td",null,r(l.name),1),e("td",null,[e("button",{onClick:u=>U(l.description),class:"description-btn",disabled:!l.description},r(l.description?"View":"None"),9,de)]),e("td",null,[$(e("input",{type:"checkbox",id:`permission-${l.id}-table`,value:l.id,"onUpdate:modelValue":t[2]||(t[2]=u=>d.value=u)},null,8,re),[[G,d.value]])])]))),128))],64))),128))])])])):(a(),i("div",ce,[e("div",ue,[(a(!0),i(_,null,g(v.value,(n,s)=>(a(),i("div",{key:s,class:"permission-group"},[e("div",ve,[e("input",{class:"mx-2 my-auto",type:"checkbox",id:`group-${s}`,checked:P(s),".indeterminate":M(s),onChange:l=>x(s,l)},null,40,pe),e("label",{for:`group-${s}`},r(s.charAt(0).toUpperCase()+s.slice(1)),9,he)]),e("div",_e,[(a(!0),i(_,null,g(n,l=>(a(),i("div",{key:l.id,class:"permission-item"},[e("div",me,[$(e("input",{type:"checkbox",id:`permission-${l.id}`,value:l.id,"onUpdate:modelValue":t[3]||(t[3]=u=>d.value=u)},null,8,be),[[G,d.value]]),e("label",{for:`permission-${l.id}`},r(l.name),9,fe)]),e("button",{onClick:u=>U(l.description),class:"description-btn",disabled:!l.description},r(l.description?"View Description":"No Description"),9,ke)]))),128))])]))),128))])]))],64)),e("button",{onClick:R,class:"submit-btn",disabled:d.value.length===0||!p.value},r(D(y)?o.$t("role.updateWithPermissions"):o.$t("role.createWithPermissions")),9,ye),f.value?(a(),i("div",{key:2,class:"modal-overlay",onClick:t[5]||(t[5]=O(n=>f.value=!1,["self"]))},[e("div",$e,[ge,e("p",null,r(S.value),1),e("button",{onClick:t[4]||(t[4]=n=>f.value=!1),class:"close-modal"},"Close")])])):E("",!0)])),[[h,"edit roles"]])}}},De=T(Ce,[["__scopeId","data-v-370d5b0f"]]);export{De as default};
